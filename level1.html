<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Where's Waldo?</title>
    <link rel="stylesheet" href="level1.css" />
    <link rel="stylesheet" href="game.css" />
  </head>
  <body data-level="level1.html">
    <header class="header">
      <img src="assets/icons/waldoheader.png" alt="Waldo Icon" class="logo" />
      <h1>
        <span class="text-blue">Whereâ€™s</span>
        <span class="text-red">Waldo?</span>
        Play Online
      </h1>
      <a href="home.html" class="back-btn">Back to Home</a>
    </header>
    <div id="status-bar">
      <div class="char-status" data-char="waldo">
        <img src="assets/icons/waldo.png" alt="Waldo" />
        <span class="time"></span>
        <div class="checkmark">âœ”</div>
      </div>

      <div class="char-status" data-char="odlaw">
        <img src="assets/icons/odlaw.png" alt="Odlaw" />
        <span class="time"></span>
        <div class="checkmark">âœ”</div>
      </div>

      <div class="char-status" data-char="wizard">
        <img src="assets/icons/wizard.png" alt="Wizard" />
        <span class="time"></span>
        <div class="checkmark">âœ”</div>
      </div>
    </div>

    <div id="game-container">
      <img id="scene" src="assets/waldo-scene.jpg" alt="Waldo Scene" />

      <!-- Waldo Debug Box -->

      <!-- Click Menu -->
      <div id="click-menu" class="click-menu">
        <button data-char="waldo">
          <img src="assets/icons/waldo.png" alt="Waldo" />
          <span>Waldo</span>
        </button>
        <button data-char="odlaw">
          <img src="assets/icons/odlaw.png" alt="Odlaw" />
          <span>Odlaw</span>
        </button>
        <button data-char="wizard">
          <img src="assets/icons/wizard.png" alt="Wizard" />
          <span>Wizard</span>
        </button>
      </div>
    </div>

    <div id="message"></div>
    <div id="level-complete" class="level-complete">
      <div class="popup">
        <h2 id="level-text">Level Completed!</h2>

        <textarea
          id="level-comment"
          placeholder="Add a comment (optional)..."
        ></textarea>
        <p id="level-submission-error"></p>

        <button id="next-level-btn">Submit & Play Next Level</button>
      </div>
    </div>

    <!-- Level Leaderboard -->
    <section id="level-leaderboard-section">
      <h2>Level 1 Leaderboard</h2>
      <table class="level-leaderboard-table">
        <thead>
          <tr>
            <th>Rank</th>
            <th>Player</th>
            <th>Time</th>
            <th>Comment</th>
            <th>Date</th>
          </tr>
        </thead>
        <tbody id="level-leaderboard-body">
          <!-- Populated by JS -->
        </tbody>
      </table>
    </section>
    <!-- Final Game Completion Popup -->
    <div id="final-run-modal">
      <div class="final-run-box">
        <h2>ðŸŽ‰ Congratulations!</h2>
        <p id="final-run-time-text">You finished all levels!</p>

        <label>Add a comment (optional):</label>
        <textarea id="final-comment" placeholder="Your comment..."></textarea>
        <p
          id="submission-error"
          style="color: red; display: none; margin-top: 5px; font-size: 14px"
        ></p>

        <button id="submit-final-score">Submit Score</button>
        <button id="play-again">Play Again</button>
      </div>
    </div>

    <!-- Firebase App -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>

    <!-- Firestore Database -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <!-- Firebase Functions (will be used later for secure hit detection) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-functions-compat.js"></script>
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyDwdvn_rKsrN2oQiJliMPT5APFzHzR3qjU",
        authDomain: "whereswaldo-212b3.firebaseapp.com",
        projectId: "whereswaldo-212b3",
        storageBucket: "whereswaldo-212b3.firebasestorage.app",
        messagingSenderId: "907907543138",
        appId: "1:907907543138:web:bb63de1a0f05d8fb18e13b",
      };

      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();
      const functions = firebase.functions();
    </script>
    <script type="module" src="game.js"></script>
    <script type="module" src="level1.js"></script>

    <!-- Player Name Modal -->
    <div id="name-modal" class="name-modal">
      <div class="name-box">
        <h3>Enter Your Player Name</h3>
        <input
          id="player-name-input"
          type="text"
          maxlength="20"
          placeholder="Your name"
        />
        <button id="save-player-name">Start Game</button>
      </div>
    </div>
  </body>
</html>
